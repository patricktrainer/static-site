
    <!DOCTYPE html>
    <html>
        <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width">
            <title>From “What is a Markov Model” to “Here is how Mark ec22e4d1d9d54a94b2f50cfe87242a8d</title>
            
            
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/open-fonts@1.1.1/fonts/inter.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css">
    <link rel="stylesheet" href="https://unpkg.com/github-syntax-dark@latest/lib/github-dark.css"/>
    
        </head>
        <body>
            <header>
                <nav>
                    <a href="https://patricktrainer.github.io/static-site">Home</a> /
                    <a href="https://github.com/patricktrainer">GitHub</a> / 
                </nav>
            </header>
            <h1>From “What is a Markov Model” to “Here is how Markov Models Work” - By</h1>
<p>Created: Feb 21, 2020 12:22 PM
URL: https://hackernoon.com/from-what-is-a-markov-model-to-here-is-how-markov-models-work-1ac5f4629b71</p>
<p>To be honest, if you are just looking to answer the age old question of “what is a Markov Model” you should take a visit to Wikipedia (or just check the TLDR 😉), but if you are curious and looking to use some examples to aid in your understanding of <em>what</em> a Markov Model is, <em>why</em> Markov Models Matter, and <em>how to implement</em> a Markov Model stick around :) <strong>Show &gt; Tell</strong></p>
<blockquote>
<p>TLDR: “In probability theory, a Markov model is a stochastic model used to model randomly changing systems where it is assumed that future states depend only on the current state not on the events that occurred before it (that is, it assumes the Markov property). Source: https://en.wikipedia.org/wiki/Markov_model</p>
</blockquote>
<p>Roadmaps are great! Check out this <strong>table of contents</strong> for this article’s roadmap 🚗</p>
<h3>Table of Contents</h3>
<h3>A. Intro To Markov Models 👶</h3>
<ol>
<li>Starter Sentence</li>
<li>Weighted Distributions</li>
<li>Special Additions</li>
<li><em>How</em> a Markov Model Works</li>
<li>Full Example Summary</li>
</ol>
<h3>B. Further Markov Model Topics 😼</h3>
<ol>
<li>Larger Example</li>
<li>Distribution</li>
<li>Bigger Windows</li>
</ol>
<h3>C. Implementation - Python 🐍</h3>
<ol>
<li>Dictogram Data Structure</li>
<li>Hash Table Data Structure</li>
<li>Markov Model Structure</li>
<li>Parse Markov Model</li>
</ol>
<h3>D. Further Readings, Suggestions, Thoughts 💚</h3>
<ol>
<li>Applications</li>
<li>Further Reading</li>
<li>Final Thoughts</li>
</ol>
<h3>Intro To Markov Models (☝️ 🐠 ✌️ 🐠 ⭕️ 🐠 🌀 🐠)</h3>
<p><strong>1. Starter Sentence</strong> | Definitely the best way to illustrate Markov models is through using an example. In this case we are going to use the same example that I was also presented when learning about Markov Models at <a href="https://medium.com/@makeschool">Make School</a>.</p>
<blockquote>
<p>“One fish two fish red fish blue fish.” -Dr. Seuss 🎩</p>
</blockquote>
<p><strong>2. Weighted Distributions</strong> | Before we jump into Markov models we need to make sure we have a strong understanding of the <strong>given starter sentence, weighted distributions,</strong> and <strong>histograms</strong>.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1Q20t6KQDq0GhrF-NCyqxHg.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1Q20t6KQDq0GhrF-NCyqxHg.png" /></p>
<p>Starter Sentence</p>
<p>Cool, our starter sentence is a well known phrase and on the surface nothing may explicitly jump out. But we are going to break it down and look at what <em>composes</em> this exact sentence. Specifically, it consists of eight words (<strong>tokens</strong>) but only five unique words (<strong>keys</strong>).</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1GwzLn-9tMkRI4dRclS3now.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1GwzLn-9tMkRI4dRclS3now.png" /></p>
<p>Colored Starter Sentence</p>
<p>Here I gave each unique word (<strong>key</strong>) a different color and on the surface this is now just a colored sentence…but alas, there is more meaning behind coloring each <strong>key</strong> differently. By coloring each unique <strong>key</strong> differently we can see that certain <strong>keys</strong> appear much more often than others.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1gnwXq22M3L3-bBXibqXqaw.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1gnwXq22M3L3-bBXibqXqaw.png" /></p>
<p>Distribution of keys</p>
<p>By looking at the above <strong>distribution</strong> of <strong>keys</strong> we could deduce that the <strong>key</strong> fish comes up 4x as much as any other <strong>key.</strong> This type of statement can led us to even further predictions such as if I randomly had to pick the next word at any point in the starter sentence my best guess would be saying “fish” because it occurs significantly more in the sentence than any other word. 💯
In our situation <strong>weighted distributions</strong> are the percentage that one key will appear is based on the total amount of times a key shows up divided by the total amount of tokens. For example, the weighted distribution for fish is 50% because it occurs 4 times out of the total 8 words. Then One, two, red, blue all have a 12.5% chance of occurring (1/8 each).</p>
<p><strong>Histograms</strong> are a way to represent weighted distributions, often they are a plot that enables you to discover the underlying frequency distribution of a set of continuous data. In our case the continuous data is a <em>sentence</em> because a sentence consists of many words (continuous data).</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1sqA96Aytk6GG1IIMlPR_EA.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1sqA96Aytk6GG1IIMlPR_EA.png" /></p>
<p>Histogram for our starter sentence</p>
<p>By looking at the <strong>histogram</strong> of our starter sentence we can see the underlying distribution of words <strong>visually 👀</strong> Clearly, fish appears more than anything else in our data set 🐠🐟 🐡🐠</p>
<p><strong>3. Special Additions</strong> | Great! At this point you should be comfortable with the concept that our <em>sentence</em> consists of many <strong>tokens</strong> and <strong>keys.</strong> Additionally, you should understand the relationship between a <strong>histogram</strong> and <strong>weighted distributions</strong>.</p>
<p>✅💯✅ <strong>Extra Example</strong> ✅💯✅</p>
<p>A <strong>token</strong> is any word in the sentence.
A <strong>key</strong> is a unique occurrence of a word.<strong>Example: “</strong><em>Fish Fish Fish Fish Cat”</em> there are two <strong>keys</strong> and five <strong>tokens.</strong> The keys are “Fish” and “Cat” (🐠 and 😺). Then any word is a token.
A <strong>histogram</strong> is related to <strong>weighted distibutions</strong> because a histogram visually shows the frequency of data in a continuous data set and in essence that is demonstrating the weighted distribution of the data.</p>
<p>✅💯✅ <strong>End</strong> ✅💯✅</p>
<p>Cool, so now we understand our sentence at the surface and how certain words occur more than others But before we continue we need to add some special additions to our sentence that are hidden on the surface but we can agree are there. The <strong>Start</strong> and <strong>End</strong> of the sentence…</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1U06RW22yqWz8tK9gMeQ3MA.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1U06RW22yqWz8tK9gMeQ3MA.png" /></p>
<p>Starter Sentence with Special Additions</p>
<p>Awesome! Take a moment and check out the above “additions” to the sentence that exist. This may seem unnecessary right now, but trust me, this will make exponentially more sense in the next part where we dive into Markov models 😌. In summary, every sentence proceeds by an invisible “<em>START</em>” symbol and it always concludes with an “<em>END</em>” symbol.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1okyW8itkBNhiugBqZX3k0A.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1okyW8itkBNhiugBqZX3k0A.png" /></p>
<p>Distribution of Keys in Modified Example</p>
<p>Above, I went ahead and recreated the same distribution of keys from earlier but included our two additional keys (<em>START</em> and <em>END</em>).</p>
<p><strong>4. <em>How</em> a Markov Model Works</strong> | Fantastic! You already may have learned a few things, but now here comes the meat of the article. Lets start from a high level definition of <em>What</em> a Markov Model is (according to <a href="https://en.wikipedia.org/wiki/Markov_model">Wikipedia</a>):</p>
<blockquote>
<p>“A Markov model is a stochastic model used to model randomly changing systems where it is assumed that future states depend only on the current state not on the events that occurred before it (that is, it assumes the Markov property). Generally, this assumption enables reasoning and computation with the model that would otherwise be intractable.”-Wikipedia</p>
</blockquote>
<p>Awesome! Sounds interesting…but what does that huge blob even mean? I bolded the <strong>critical</strong> portion of <em>what</em> a Markov Model is. In summary, a Markov Model is a model where the <strong>next state</strong> is solely chosen based on the <strong>current state</strong>.</p>
<p>One way to think about it is you have a window that only shows the current state (or in our case a single token) and then you have to determine what the next token is based on that small window!</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1xZwT88rLbYZhvAkx-XbOsw.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1xZwT88rLbYZhvAkx-XbOsw.png" /></p>
<p>Demonstrating the next word using a window</p>
<p>Above, I showed how each token leads to another token. Additionally, I colored the arrow leading to the next word based on the origin key. I recommend you spend some time on this diagram and the following ones because they build the foundation of <em>how</em> Markov Models work! 🤓</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/110vdH6xwkhX93ETi9ATsIw.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/110vdH6xwkhX93ETi9ATsIw.png" /></p>
<p>Pairs! Every Token leads to another Token!</p>
<p>You may have noticed that every token leads to another one (even the <em>END</em>, leads to another token — <em>none</em>). In this case it forms pairs of one token to another token!</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1UGdrm8lZmk1Lp3OxguaYWA.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1UGdrm8lZmk1Lp3OxguaYWA.png" /></p>
<p>Organized pairs by starting word</p>
<p>Above, I simply organized the pairs by their first token. At this point you may be recognizing something interesting 🤔 Each starting token is followed <strong>only</strong> by a possible key to follow it…</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1QEIDJPVBcct-Jld6cDdUKQ.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1QEIDJPVBcct-Jld6cDdUKQ.png" /></p>
<p>Possible tokens to follow each key</p>
<p>Ok, so hopefully you have followed along and understood that we are organizing pairs which we formed by using a <strong>“window”</strong> to look at what the next token is in a pair. Then above I trimmed the pairs down even further into something very interesting. Every <strong>key</strong> is matched with an array of possible tokens that could follow that key.</p>
<p>✨💡✨ <strong>Thinking Break</strong> ✨💡✨</p>
<p>Let’s take a moment to think about the above diagram. Every <strong>key</strong> has possible words that <strong><em>could</em></strong> follow it. If we were to give this structure from above to someone they could potentially recreate our original sentence!</p>
<h3><strong>Example:</strong></h3>
<p>We give them <strong><em>Start</em></strong> to begin with, then we look at the potential options of words that <strong><em>could</em></strong> follow <em>START</em> → [One]. Being that there is only key that follows we have to pick it. Our sentence now looks like “One.” Let’s continue by looking at the potential words that <strong><em>could</em></strong> follow “One” → [fish]. Well again, that was easy only “fish” can follow One. Now our sentence is “One fish.” Now let’s see what <strong><em>could</em></strong> follow “fish” → [two, red, blue, <em>END</em>]. Here is where things get interesting any of these four options <strong><em>could</em></strong> be picked next 😳. Which means we <strong><em>could</em></strong> pick “two” and then continue and potentially get our original sentence…but there is a 25% (1/4) chance we just randomly pick “<em>END</em>”. If this was the case we would have used our original structure and randomly generated a sentence very different than our original → “One fish.” 1️⃣ 🐠</p>
<p>✨💡✨ <strong>End</strong> ✨💡✨</p>
<p>Congrats! 🎉🎉 You secretly just acted out a Markov Model in the above <strong>Thinking Break</strong> 😏. Nice! But seriously…think about it. We used the <strong>current state</strong> (current key) to determine our <strong>next state</strong>. Further our next state could only be a key that follows the current key. Sounds cool, but it gets even cooler! Let’s diagram a Markov Model for our starter sentence.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1x4CnHyAqGkPa7ews_5f0sQ.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1x4CnHyAqGkPa7ews_5f0sQ.png" /></p>
<p>Markov Model for the Starter Sentence</p>
<p>Yikes 🙃 How does the above diagram represent what we just did? Look closely, each <em>oval</em> with a word inside it represents a <strong>key</strong> with the <em>arrows</em> pointing to potential <strong>keys</strong> that can follow it! But wait it gets even cooler:</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1UuD1-B7CFn3M2nUDy02sHg.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1UuD1-B7CFn3M2nUDy02sHg.png" /></p>
<p>Markov Model for the Starter Sentence with Probability</p>
<p>Yep! Each arrow has a probability that it will be selected to be the path that the current state will follow to the next state.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1MbHRwYNA8F29hzes8EPHiQ.gif" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1MbHRwYNA8F29hzes8EPHiQ.gif" /></p>
<p>Full Gif of the Starter Sentence being Created Using A Markov Model.</p>
<p>Awesome! In summary, we now understand and have illustrated a Markov Model by using the Dr. Seuss starter sentence. As a <strong>fun fact</strong>, the data you use to create your model is often referred to as a <strong>corpus 👻</strong></p>
<p><strong>5. Full Example Summary</strong> | You made it! Congrats again 🏅 at this point you likely can describe what a Markov Model is and even possibly teach someone else how they work using this same basic example! You my friend are going places 🚀. But guess what! This was just the beginning of your fuller understanding of Markov Models in the following sections we will continue to grow and expand your understanding :) Remember distributions? Well we are going to use them in the next example to show how to use <strong>weighted distributions</strong> to <em>potentially</em> create a more accurate model; Further, we will talk about <strong>bigger windows</strong> 😲 (bigger is better, right? 🙄); and lastly we will implement a nifty Markov Model in Python 🐍. So buckle up and enjoy the ride 🔥🎢</p>
<h3>Further Markov Model Topics 😼</h3>
<p><strong><em>*</em>*Disclaimer</strong>**** 🦊 I am going to be following the same process as above for creating the Markov Model, but I am going to omit some steps. If something appears confusing refer back to the first section 🔥</p>
<p><strong>1. Larger Example</strong> | Keeping in the spirit of Dr. Seuss quotes I went ahead and found four quotes that Theodor Seuss Geisel has <strong>immortalized:</strong></p>
<blockquote>
<p>“Today you are you. That is truer than true. There is no one alive who is you-er than you.”</p>
<p>“You have brains in your head. You have feet in your shoes. You can steer yourself any direction you choose. You’re on your own.”</p>
<p>“The more that you read, the more things you will know. The more that you learn, the more places you’ll go.”</p>
<p>“Think left and think right and think low and think high. Oh, the thinks you can think up if only you try.” -Dr. Seuss 🎩</p>
</blockquote>
<p>The biggest difference between the original starter sentence and our new sentence is the fact that some <strong>keys</strong> follow different keys a <strong>variable amount</strong> of times. For example “more” follows “the” four times. So what will this additional complexity do to our Markov Model construction? 🤔 Well overall it <strong>can improve</strong> our logical outcome for our sentences. What I mean by that is: There are certain words in the english language (or any language for that matter 🇷🇴) that come up wayyyy more often than others. For example the word “a” comes up significantly more in day to day conversation than “wizard” 🎩. Just how the world works 🌎 With that in mind, knowing how often in comparison one key shows up vs a different key is <strong>critical</strong> to seeming more realistic 😊 This is known as taking the <strong>weighted distribution</strong> into account when deciding what the next <strong>step</strong> should be in the Markov Model.</p>
<p>One way to programmatically 💻 represent this would be for each <strong>key</strong> that follows a <strong>window</strong> you store the <strong>keys</strong> and the amount of <strong>occurrences</strong> of that key! This can be done via having a dictionary and the dictionary <em>key</em> would represent the <strong>current window</strong> and then have the <em>value</em> of that <em>dictionary key</em> be another dictionary that store the <strong>unique tokens</strong> that follow as <em>keys</em> and their <em>values</em> would be the <strong>amount of occurrences…</strong>Does this remind you of something we already talked about 📊? <strong>Histograms</strong>! Exactly! The <em>inner dictionary</em> is severing as a histogram - it is soley keeping track of <strong>keys</strong> and their <strong>occurrences</strong>! Wow, ok so many keys 🔑 were brought up and dictionaries too if you are curious about the code you should certainly check it out below👇 But otherwise, just recognize that in order to create a more advanced model we need to track what <strong>keys</strong> proceed other <strong>keys</strong> and the <strong>amount of occurrences</strong> of these keys.</p>
<p><strong>2. Distribution</strong> | Awesome, quick tangent and then we will start tearing into this example 😋🍴 Cool so even this data set is <strong><em>very</em></strong> small to be a good corpus! Why? Well, we will get different distribution of words which is great and will impact the entire structure, but in the larger scope of generating <strong>natural</strong> <strong>unique</strong> generated sentences you should aim to have at <strong>minimum 20,000</strong> tokens. It would be better if you would have at least <strong>100,000,</strong> tokens. Then if you want to have a truly spectacular model you should aim for <strong>500,000</strong>+ tokens 🚀</p>
<p>But lets chat about how the distribution of words are in a <strong>one key window</strong> with this larger example.</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1e8mGc21E4cK5A-gixEoFoA.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1e8mGc21E4cK5A-gixEoFoA.png" /></p>
<p>Colored distribution of keys</p>
<p>Wow! Very cool 😎 Look at all that data - I went ahead and cleaned the data up and now you can see that each unique <strong>key</strong> in our corpus has an array of all of the <strong>keys</strong> and <strong>occurrences</strong> that follow the unique key. Very nice!</p>
<p>Want to know a little secret? 😏 There is very little difference between this and the previous Markov model because in both situations we make decisions on the next step <strong>solely based on the current status</strong> but storing the distribution of words allows us to weight the next step. Lets look at a real example from our data:</p>
<p><code>more : [things : 1, places : 1, that : 2]</code></p>
<p>Awesome! 👏 So if the Markov Model’s current status was “more” than we would randomly select one of the following words: “things”, “places”, and “that”. However, “that” appears twice as opposed to “things” and “places” which occur once. Therefore, there is a 50% chance “that” would be selected and a 25% that either “things” or “places” is selected! 😃</p>
<p><code>think : [high : 1, up : 1, right : 1, low : 1, left : 1]</code></p>
<p>☝️☝️☝️ Awesome, similar example as above, but in this case “high”, “up”, “right”, “low”, and “left” all have a 20% chance of being selected as the next state if “think” is the current state! Make sense? 💭</p>
<p><strong>3. Bigger Windows</strong> | Currently, we have only been looking at markov models with <em>windows</em> of size one. We could increase the size of the window to get more <strong>“accurate” sentences</strong>. By more accurate I mean there will be less randomness in the generated sentences by the model because they will be closer and closer to the original corpus sentences. This can be good or bad 😇 😈 This is because if your purpose of the Markov Model is to generate some truly unqiue random sentences it would need to be a smaller window. A larger window is only a good idea if you have a <strong><em>significantly</em></strong> large corpus <strong>100,000+ tokens.</strong></p>
<p>Increasing the size of the window is known as bringing the Markov Model to a <strong>“higher order”</strong>. The current examples we have worked with have been <strong>first order markov models.</strong> If we use a second order Markov Model our window size would be two! Similarly, for a third order → window size of three.</p>
<p>The window is the data in the current state of the Markov Model and is what is used for decision making. If there is a bigger window in a smaller data set it is unlikely that there will be large unique distributions for the possible outcomes from one window therefore it could <strong>only recreate the same sentences.</strong></p>
<p>Let’s look at our original example with a <strong>second order Markov Model</strong> - window of size two! 2️⃣</p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1PXimcZKB-1y82tQJNTZ94g.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1PXimcZKB-1y82tQJNTZ94g.png" /></p>
<p>2nd order Markov Model Data</p>
<p>Very interesting! Any observations? 🕵️ You may have noticed that every unique window of size two only has <strong>one possible outcome</strong>…therefore no matter where we start we will always get the same sentence because there is no possibility of deviating off the original path. There is a 100% chance we generate the same sentence 👎 Not great. This reveals a potential issue you can face with Markov Models…if you do not have a large enough corpus you will likely only generate sentences within the corpus which is not generating anything unique. Get a <strong>huge data set - 500,000+ tokens</strong> and then <strong>play</strong> <strong>around</strong> with using <strong>different orders</strong> of the Markov Model 👍</p>
<h3>Implementation — Python 🐍</h3>
<p><strong>1. Dictogram Data Structure</strong> |
The Dictogram purpose of the Dictogram is to act as a histogram but have incredibly fast 💨 and constant look up times regardless how large our data set gets. Basically it is a histogram built using a dictionary because dictionaries has the unique property of having constant lookup time O(1)!</p>
<p>The dictogram class can be created with an iterable data set, such as a list of words or entire books. I keep track of <strong>token</strong> and <strong>key</strong> count as I create it just so I can access those values without having to go through the entire data set 🤓</p>
<p>It is also good to note that I made two functions to return a random word. One just <strong>picks a random key</strong> and the other function takes into account the amount of occurrences for each word and then returns a <strong>weighted random word!</strong> <strong>🏋️‍♀️</strong></p>
<p><strong>2. Markov Model Structure</strong> |
Wow! It has been quite a journey to go from <strong><em>what</em></strong> is a Markov Model to now be talking about <strong><em>how to</em></strong> implement a Markov Model 🌄</p>
<p><a href="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/13122645">From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/13122645</a></p>
<p>In my implementation I have a <strong>dictionary</strong> that stores <em>windows</em> as the <strong>key in the key-value pair</strong> and then the <em>value</em> for each <em>key</em> is a <strong>dictogram</strong>. Basically I store a histogram of words for each window so I know what the next state can be based on a current state 😌 We increment the data in the dictogram for a key if it already exists in the current window!</p>
<p><strong>3. Nth Order Markov Model Structure |</strong>Some of you are definitely curious about how to <strong>implement higher order Markov Models</strong> so I also included how I went about doing that 😏</p>
<p>☝️☝️☝️☝️☝️ Very similar to the first order Markov Model, but in this case we store a <strong><em>tuple</em></strong> as the <strong>key</strong> in the <strong>key-value pair</strong> in the <strong>dictionary</strong>. We do this because a <strong><em>tuple</em></strong> is a great way to represent a single list. And we use a tuple instead of a list because a key in a dictionary should not change and tuples are immutable sooo 🤷‍♂️</p>
<p><strong>4. Parse Markov Model</strong> |
Yay!! 🎉👏 🎉 We now have implemented a dictogram, but how do we now do the thing where we generate content based on <strong>current status</strong> and <strong>step</strong> to a new state? 👇👇👇Here we will walk through our model 🚶</p>
<p>Great, so I <em>personally</em> wanted to be able to only use valid starting sentence words so I checked anything in the <strong>END</strong> key dictogram 🐶. Otherwise, you start the generated data with a <strong>starting state</strong> (which I generate from valid starts), then you just keep looking at the <strong>possible keys</strong> (by going into the dictogram for that key) that could <strong>follow the current state</strong> and <strong>make a decision</strong> based on <em>probability</em> and <em>randomness</em> (<strong>weighted probability</strong>). We keep repeating this until we do it <strong><em>length</em></strong> times! 💯</p>
<h3>Further Readings, Suggestions, Thoughts 💚</h3>
<p><strong>1. Applications</strong> | Some classic examples of Markov models include peoples actions based on weather, the stock market, and tweet generators! 🐣 Think about how you could use a <strong>corpus</strong> to create and <strong><em>generate new content</em></strong> based on a <strong>Markov Model</strong>. Think about what would change?
Hint: Not too much, if you have a solid understanding of what, why, and how Markov Models work and can be created the <strong>only difference</strong> will be <em>how you parse the Markov Model</em> and if you add any <em>unique restrictions.</em></p>
<p>For example, in my dope <strong><a href="http://bit.ly/SVTweets">silicon valley tweet generator</a></strong> I used a larger window, limited all my generated content to be less than 140 character, there could be a variable amount of sentences, and I used only existing sentence starting windows to “seed” the sentences. 🌱</p>
<p><strong>2. Further Reading</strong> | Now that you have a good understanding of what a Markov Model is maybe you could explore how a Hidden Markov Model works. Or maybe if you are more inclined to build something using your new found knowledge you could read my artcile on building a HBO Silicon Valley Tweet Generator using a markov model (coming soon) !</p>
<p><strong>3. Final Thoughts</strong> | I am always looking for feedback so please feel free to share your thoughts on how the article was structured, the content, examples, or anything else you want to share with me 😊 Markov Models are great tools and I encourage you to build something using one…maybe even your own tweet generator 😜 Cheers! 🤗</p>
<p><em>If you liked this article, click the💚 below so other people will see it here on Medium.</em></p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1fKzgMQaOI_ox1w-PzkYvUQ.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1fKzgMQaOI_ox1w-PzkYvUQ.png" /></p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1fSiuSUFIo6lGt2XKJWyqgg.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1fSiuSUFIo6lGt2XKJWyqgg.png" /></p>
<p><img alt="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1_1ZNPfn7_5dSLRg4Eu8Bcw.png" src="From%20%E2%80%9CWhat%20is%20a%20Markov%20Model%E2%80%9D%20to%20%E2%80%9CHere%20is%20how%20Mark%20ec22e4d1d9d54a94b2f50cfe87242a8d/1_1ZNPfn7_5dSLRg4Eu8Bcw.png" /></p>
        </body>
    </html>
    